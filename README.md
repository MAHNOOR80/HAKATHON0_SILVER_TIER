# Silver Tier AI Employee (Functional Assistant)

An autonomous AI Employee system that monitors multiple input channels, plans and executes tasks, posts to LinkedIn, sends emails, and enforces human approval for sensitive actions. Built on Obsidian with Claude Code as the AI backbone.

## Overview

The Silver Tier AI Employee is an evolution of the Bronze Tier. It adds Gmail monitoring, LinkedIn automation, a full MCP server for external actions, a human-in-the-loop approval workflow, scheduled task planning, and a library of Agent Skills that define all AI behavior. Everything runs through markdown files in an Obsidian vault.

## Architecture

```
                        +------------------------+
                        |     Claude Code (AI)   |
                        |   Reads/writes vault   |
                        +----------+-------------+
                                   |
                    +--------------+--------------+
                    |                             |
            +-------+--------+          +---------+---------+
            | Agent Skills   |          | MCP Server        |
            | (AI behavior)  |          | (external actions)|
            +-------+--------+          +---------+---------+
                    |                             |
     +--------------+--------------+    +---------+---------+
     |              |              |    |         |         |
  Planning    Approval Gate   LinkedIn  Email   LinkedIn  Config
  Skill       + Handler       Skill    send    post      check
                    |
            +-------+--------+
            | Pending_Approval|
            | (human reviews) |
            +----------------+
```

## Folder Structure

```
Silver/
+-- Inbox/                  # Drop files here for processing
+-- Needs_Action/           # Tasks awaiting AI processing
+-- Pending_Approval/       # Tasks gated for human approval
+-- Done/                   # Completed tasks archive
+-- Plans/                  # Execution plans generated by AI
+-- Logs/                   # System logs and error logs
+-- Agent_Skills/           # All AI behavior definitions
|   +-- Plan_Tasks_Skill.md
|   +-- Approval_Check_Skill.md
|   +-- Approval_Handler_Skill.md
|   +-- LinkedIn_Post_Skill.md
|   +-- MCP_Action_Logger_Skill.md
+-- mcp_server/             # Node.js MCP server
|   +-- mcp_server.js       # Server with 3 tools
|   +-- package.json
|   +-- .env.example
+-- file_watcher.py         # Watcher 1: file system monitor
+-- gmail_watcher.py        # Watcher 2: Gmail IMAP monitor
+-- scheduler.py            # Hourly task scheduling
+-- log_manager.py          # Log rotation utility
+-- Dashboard.md            # Central status hub
+-- Company_Handbook.md     # Operating rules
+-- .mcp.json               # MCP server configuration
```

## Silver Tier Requirements - All Met

| # | Requirement | Implementation | Status |
|---|------------|----------------|--------|
| 1 | Bronze Tier foundations | Obsidian vault, Dashboard, Handbook, folders, file watcher, Agent Skills | Done |
| 2 | Expanded Perception (2+ watchers) | `file_watcher.py` + `gmail_watcher.py` | Done |
| 3 | Business Automation (LinkedIn) | `LinkedIn_Post_Skill.md` + `post_linkedin` MCP tool | Done |
| 4 | Reasoning Loop (Plan.md) | `Plan_Tasks_Skill.md` generates plans in `/Plans/` | Done |
| 5 | External Actions (MCP) | `mcp_server.js` with send_email, post_linkedin, check_email_config | Done |
| 6 | Human-in-the-Loop | Approval_Check_Skill + Approval_Handler_Skill + `/Pending_Approval/` | Done |
| 7 | Scheduling | `scheduler.py` with hourly checks via Python schedule library | Done |
| 8 | Technical Standard | All AI functionality in 5 Agent Skills | Done |

## How It Works

### Complete Workflow

```
1. PERCEPTION: Watchers detect new input
   file_watcher.py  -->  new file in /Inbox/     -->  task in /Needs_Action/
   gmail_watcher.py -->  new email in Gmail       -->  task in /Needs_Action/

2. PLANNING: AI creates execution plans
   Plan_Tasks_Skill  -->  analyzes /Needs_Action/  -->  Plan.md in /Plans/

3. APPROVAL CHECK: Gate before sensitive actions
   Approval_Check_Skill  -->  send_email? post_linkedin?
     --> Yes: move to /Pending_Approval/, update Dashboard, STOP
     --> No:  proceed to execution

4. HUMAN REVIEW: User approves or rejects
   /Pending_Approval/task.md  -->  user sets approved: true (or status: rejected)

5. EXECUTION: Approved actions are performed
   Approval_Handler_Skill  -->  calls MCP tool  -->  move to /Done/
   MCP_Action_Logger_Skill -->  logs result to Dashboard + System_Log

6. SCHEDULING: Runs hourly to trigger planning
   scheduler.py  -->  checks /Needs_Action/  -->  creates planning tasks
```

### Task File Format (Silver Tier)

```yaml
---
type: email_response | linkedin_post | file_review | general_task
status: pending | in_progress | pending_approval | completed | rejected
priority: high | medium | low
created_at: 2026-02-05 22:00:00
completed_at: 2026-02-05 23:00:00
related_files: ["Inbox/file.txt"]
approval_needed: true | false
approved: true | false
mcp_action: ["send_email", "post_linkedin"]
source: file_watcher | gmail_watcher
---
```

## Components

### Watchers (Expanded Perception)

#### file_watcher.py - File System Monitor

Monitors `/Inbox/` for new files and auto-creates task files.

```bash
python file_watcher.py
```

- Checks every 5 seconds
- Creates tasks with YAML frontmatter in `/Needs_Action/`
- Duplicate prevention via processed file tracking
- Error logging to `Logs/watcher_errors.log`

#### gmail_watcher.py - Gmail IMAP Monitor

Monitors a Gmail inbox for new emails and auto-creates task files.

```bash
# Demo mode (no credentials needed):
python gmail_watcher.py

# Live mode (with credentials):
set GMAIL_USER=your_email@gmail.com
set GMAIL_APP_PASSWORD=your_app_password
python gmail_watcher.py
```

- Checks every 60 seconds via IMAP
- Parses sender, subject, body from emails
- Smart approval detection (flags emails requesting replies)
- Demo mode simulates 3 incoming emails for demonstration
- Duplicate prevention via Message-ID tracking
- Error logging to `Logs/gmail_watcher_errors.log`

**Gmail Setup (Live Mode):**
1. Enable IMAP in Gmail: Settings > See all settings > Forwarding and POP/IMAP
2. Enable 2-Step Verification on your Google Account
3. Generate App Password: Google Account > Security > App Passwords
4. Set environment variables: `GMAIL_USER` and `GMAIL_APP_PASSWORD`

### MCP Server (External Actions)

Node.js server exposing 3 tools via Model Context Protocol:

| Tool | Description | Approval Required |
|------|-------------|-------------------|
| `send_email` | Send emails via SMTP | Yes |
| `post_linkedin` | Publish posts to LinkedIn | Yes |
| `check_email_config` | Test SMTP connection | No |

**Setup:**
```bash
cd mcp_server
npm install
```

**Configuration** (copy `.env.example` to `.env`):
```env
# Email (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password
SMTP_FROM=your_email@gmail.com

# LinkedIn
LINKEDIN_ACCESS_TOKEN=your_access_token
LINKEDIN_PERSON_URN=urn:li:person:your_id
```

Without credentials, both tools run in **test/demo mode** (emails go to Ethereal, LinkedIn posts are logged but not published).

**LinkedIn API Setup:**
1. Go to https://developer.linkedin.com/
2. Create a new app
3. Add "Share on LinkedIn" product
4. Generate an OAuth2 access token
5. Set `LINKEDIN_ACCESS_TOKEN` and `LINKEDIN_PERSON_URN`

### Scheduler

Runs hourly checks for pending tasks and triggers planning.

```bash
pip install schedule
python scheduler.py
```

- Checks `/Needs_Action/` every 60 minutes
- Creates planning tasks when pending work is found
- Logs to System_Log.md
- Runs immediately on startup, then hourly

### Log Manager

Rotates log files when they exceed 1 MB.

```bash
python log_manager.py
```

## Agent Skills

All AI behavior is defined in `/Agent_Skills/` markdown files:

| Skill | Purpose |
|-------|---------|
| **Plan_Tasks_Skill.md** | Analyzes pending tasks, generates prioritized execution plans in `/Plans/` |
| **Approval_Check_Skill.md** | Mandatory gate before sensitive MCP actions. Moves tasks to `/Pending_Approval/` |
| **Approval_Handler_Skill.md** | Polls `/Pending_Approval/` for human decisions, executes approved tasks |
| **LinkedIn_Post_Skill.md** | Generates professional LinkedIn posts with 5 content templates |
| **MCP_Action_Logger_Skill.md** | Logs all MCP tool results to Dashboard and System_Log |

### Approval Workflow (Human-in-the-Loop)

```
Task has sensitive action (send_email, post_linkedin, etc.)
  |
  v
Approval_Check_Skill gates it
  --> YAML: status: pending_approval, approved: false
  --> File moved to /Pending_Approval/
  --> Dashboard updated with link
  --> Execution STOPPED
  |
  v
Human opens file in Obsidian and edits YAML:
  --> To approve: set approved: true
  --> To reject:  set status: rejected
  |
  v
Approval_Handler_Skill detects the change:
  --> Approved: executes MCP action, moves to /Done/
  --> Rejected: archives to /Done/, no action taken
```

**Actions that require approval:**
`send_email`, `post_linkedin`, `post_twitter`, `make_payment`, `delete_data`, `modify_config`

## AI Agent Commands

| Command | What it does |
|---------|-------------|
| "Process tasks" | Reads and executes all pending tasks in `/Needs_Action/` |
| "Make a plan for tasks" | Generates a Plan.md without executing anything |
| "Create a LinkedIn post about X" | Generates draft, gates through approval |
| "Send email to X" | Creates email task, gates through approval |
| "Check approvals" | Scans `/Pending_Approval/` and processes approved/rejected tasks |
| "Process all tasks with approval check" | Runs every task through the approval gate |

## Dashboard

`Dashboard.md` is the central status hub with these sections:

- **Pending Tasks** — Work waiting to be processed
- **Pending Approval** — Tasks gated for human review (with wiki-links)
- **Completed Tasks** — History of all completed work
- **Recent Plans** — Links to generated execution plans
- **Recent Actions** — Last 10 MCP tool calls with results
- **System Notes** — Current status, active watchers, available skills

## Operating Rules

From `Company_Handbook.md`:

1. **Always Log Important Actions** — All actions recorded in System_Log
2. **Never Take Destructive Actions Without Confirmation** — Approval required
3. **Move Completed Tasks to Done** — Keep workspace organized
4. **Keep Task Files Structured** — Consistent YAML frontmatter
5. **If Unsure, Ask for Clarification** — No guessing

## Quick Start

### Requirements

- Python 3.x
- Node.js 18+
- Claude Code
- Optional: Obsidian (for viewing the vault)

### Installation

```bash
# 1. Navigate to the project
cd Silver

# 2. Install MCP server dependencies
cd mcp_server && npm install && cd ..

# 3. Install Python scheduler dependency
pip install schedule

# 4. Start the file watcher (Terminal 1)
python file_watcher.py

# 5. Start the Gmail watcher (Terminal 2)
python gmail_watcher.py

# 6. Start the scheduler (Terminal 3)
python scheduler.py

# 7. Open the folder in Claude Code and start working
```

### Testing Without Credentials

Everything works in **demo/test mode** out of the box:
- **Gmail watcher**: Simulates 3 incoming emails
- **MCP send_email**: Routes through Ethereal test SMTP
- **MCP post_linkedin**: Logs post content, returns simulated post ID
- **Approval workflow**: Fully functional with local files

## License

This project was created for the Hackathon 0 AI Employee challenge — Silver Tier.
