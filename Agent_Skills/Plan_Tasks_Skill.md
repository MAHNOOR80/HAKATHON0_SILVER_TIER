# Plan Tasks Skill

## Description

This skill generates a strategic execution plan by analyzing all pending tasks in `/Needs_Action`. It creates a structured plan document with prioritized task ordering, risk assessment, and execution strategy. **This is a planning-only skill — it does not execute any tasks.**

## Trigger Conditions

Activate this skill when:
- User says: "Make a plan for tasks", "Plan my tasks", "Create a task plan"
- On scheduled intervals (daily planning, start of work session)
- When new tasks are added to `/Needs_Action`
- User requests task prioritization or overview

## Inputs

- All task files in `/Needs_Action/`
- YAML frontmatter from each task (type, status, priority, approval_needed, mcp_action)
- Current date/time for plan filename

## Outputs

- New plan file: `/Plans/Plan_<YYYY-MM-DD_HH-MM>.md`
- Updated `Dashboard.md` with plan reference

---

## Steps

### Step 1: Scan Needs_Action Directory

```
Read all .md files in /Needs_Action/
For each file:
  - Extract YAML frontmatter
  - Extract task title (first # heading)
  - Store: filename, type, priority, approval_needed, mcp_action, title
```

### Step 2: Categorize and Summarize Tasks

Group tasks by:
- **Priority**: high, medium, low
- **Type**: general_task, social_media_post, research, development, etc.
- **Approval Status**: needs_approval vs ready_to_execute

Count totals:
```
total_tasks = count of all tasks
high_priority = count where priority == "high"
needs_approval = count where approval_needed == true
```

### Step 3: Determine Execution Order

Sort tasks using this priority algorithm:
1. High priority + no approval needed (execute first)
2. High priority + approval needed (flag for approval)
3. Medium priority + no approval needed
4. Medium priority + approval needed
5. Low priority tasks

Within same priority level, sort by:
- Dependencies (if specified in related_files)
- Creation date (older first)

### Step 4: Identify Risks and Unclear Items

Flag tasks that have:
- Missing or incomplete descriptions
- Empty `mcp_action` but description suggests external action
- Conflicting priorities
- No clear success criteria
- Dependencies on unavailable resources

### Step 5: Generate Plan File

Create `/Plans/Plan_<YYYY-MM-DD_HH-MM>.md` with this structure:

```markdown
---
type: execution_plan
status: active
created_at: <timestamp>
related_files: [list of task files included]
approval_needed: false
mcp_action: []
---

# Task Execution Plan — <YYYY-MM-DD>

## Summary

- **Total Pending Tasks**: X
- **High Priority**: X
- **Awaiting Approval**: X
- **Ready to Execute**: X

### Tasks by Type
| Type | Count |
|------|-------|
| general_task | X |
| social_media_post | X |
| ... | ... |

## Suggested Execution Order

### Batch 1: Immediate (High Priority, No Approval)
1. [ ] **Task Title** — `filename.md` — Brief description
2. [ ] **Task Title** — `filename.md` — Brief description

### Batch 2: Needs Approval First
1. [ ] **Task Title** — `filename.md` — Requires: [approval type]

### Batch 3: Standard Priority
1. [ ] **Task Title** — `filename.md` — Brief description

### Batch 4: Low Priority / Backlog
1. [ ] **Task Title** — `filename.md` — Brief description

## Risks and Unclear Items

- [ ] **Task X**: Missing success criteria
- [ ] **Task Y**: MCP action unclear — verify before execution
- [ ] **Task Z**: Dependency on [resource] not confirmed

## Strategy

[Short paragraph describing the recommended approach for this planning period. Include any blockers that need resolution, suggested time allocation, and key decision points.]

---

_Plan generated by Plan_Tasks_Skill. This is a planning document — tasks are not executed until moved through the standard workflow._
```

### Step 6: Update Dashboard

Add entry to `Dashboard.md`:
```markdown
## Recent Plans
- Plan Generated: [[Plan_<YYYY-MM-DD_HH-MM>.md]] — X tasks planned
```

### Step 7: Log the Action

Record in System_Log:
```
[<timestamp>] Plan_Tasks_Skill: Generated Plan_<YYYY-MM-DD_HH-MM>.md with X tasks
```

---

## Example Prompt for Claude Code

When triggered, use this prompt pattern:

```
1. List all files in /Needs_Action/
2. For each file, read and extract:
   - YAML frontmatter (type, status, priority, approval_needed, mcp_action)
   - Task title from first heading
3. Group tasks by priority (high/medium/low)
4. Count tasks needing approval vs ready to execute
5. Create /Plans/Plan_<current_datetime>.md using the template above
6. Add plan reference to Dashboard.md
7. Log action to System_Log
8. Report summary to user

DO NOT execute any tasks. Planning only.
```

---

## Configuration Options

| Option | Default | Description |
|--------|---------|-------------|
| `include_completed` | false | Include recently completed tasks for context |
| `max_batch_size` | 5 | Maximum tasks per execution batch |
| `auto_flag_stale` | true | Flag tasks older than 7 days as risk items |
| `strategy_length` | short | short, medium, or detailed strategy paragraph |

---

## Notes

- Plans are snapshots — task states may change after plan generation
- Re-run this skill if significant new tasks are added
- Use plans for daily standups, prioritization discussions, or AI work sessions
- Combine with `Approval_Check_Skill` to pre-route approval-needed tasks
- Plans do not auto-execute — they inform the workflow only
